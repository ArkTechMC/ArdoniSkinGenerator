<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>64x64 图像编辑器</title>
    <style>
        #canvas {
            border: 1px solid black;
            image-rendering: pixelated;
        }
        .color-picker {
            margin: 10px;
        }
    </style>
</head>
<body>

<h1>64x64 图像编辑器</h1>
<canvas id="canvas" width="640" height="640"></canvas>
<div>
    <input type="color" class="color-picker" id="colorPicker" value="#000000">
    <button id="clearButton">清空</button>
    <input type="file" id="uploadImage" accept="image/png, image/jpeg">
</div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const pixelSize = 10; // 每个像素的大小
    const imageData = ctx.createImageData(64, 64);
    let currentColor = '#000000';

    // 绘制空白图像
    for (let i = 0; i < 64 * 64; i++) {
        imageData.data[i * 4 + 3] = 0; // 透明度
    }
    ctx.putImageData(imageData, 0, 0);

    // 处理像素点击
    canvas.addEventListener('click', (event) => {
        const rect = canvas.getBoundingClientRect();
        const x = Math.floor((event.clientX - rect.left) / pixelSize);
        const y = Math.floor((event.clientY - rect.top) / pixelSize);
        const index = (y * 64 + x) * 4;

        // 设置颜色
        imageData.data[index] = parseInt(currentColor.slice(1, 3), 16);   // R
        imageData.data[index + 1] = parseInt(currentColor.slice(3, 5), 16); // G
        imageData.data[index + 2] = parseInt(currentColor.slice(5, 7), 16); // B
        imageData.data[index + 3] = 255; // 不透明

        ctx.putImageData(imageData, 0, 0);
    });

    // 选择颜色
    document.getElementById('colorPicker').addEventListener('input', (event) => {
        currentColor = event.target.value;
    });

    // 清空图像
    document.getElementById('clearButton').addEventListener('click', () => {
        for (let i = 0; i < 64 * 64; i++) {
            imageData.data[i * 4 + 3] = 0; // 透明度
        }
        ctx.putImageData(imageData, 0, 0);
    });

    // 上传图像
    document.getElementById('uploadImage').addEventListener('change', (event) => {
        const file = event.target.files[0];
        const reader = new FileReader();
        reader.onload = function (e) {
            const img = new Image();
            img.onload = function () {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, 64, 64);
            };
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    });
</script>

</body>
</html>
